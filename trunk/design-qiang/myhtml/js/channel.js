(function(b){b.register("customevent","1.0.0.0");var a=function(c){this.events=[];this.name=c};b.Native.initialize({name:"CustomEvent",initialize:a,protect:true});a.implement({fire:function(){var d=[];for(var e=0;e<arguments.length;e++){d.push(arguments[e])}for(var e=0,c=this.events.length;e<c;e++){var f=this.events[e];f[0].call(f[1],this.name,d)}},subscribe:function(d,c){this.events.push([d,c])},clear:function(){this.events=[]}});b.CustomEvent=a})(JUI);(function(b){b.register("tab-view","1.0.0.0");var a=function(h,d,f,j){if(h.length!=d.length){alert("JUI:TabView  参数 [tabs] [views] 包含的element.length不相等");return}this.ops={tabTriggerEvent:"mouseover"};this.mergeOptions(j);for(var g=0,c=h.length;g<c;g++){h[g].attr("jsvalue",g)}this.selectedTabIx=0;var e=this;h.addEvent(this.ops.tabTriggerEvent,function(k){var i=parseInt(this.attr("jsvalue"));f(h[e.selectedTabIx],this);d[e.selectedTabIx].css("display","none");e.selectedTabIx=i;d[e.selectedTabIx].css("display","block")})};b.Native.initialize({name:"TabView",initialize:a,protect:true});a.implement({mergeOptions:function(c){for(var d in c){this.ops[d]=c[d]}}});b.TabView=a})(JUI);(function(d){d.register("ikan.user2","1.0.0.0");var c="pplive.com";if(document.domain.toLowerCase().indexOf("pptv.com")!=-1){c="pptv.com"}var e={login:"http://passport.pptv.com/weblogin.do?",addFavor:"http://bk.pptv.com/xihttp/ikan2/favor/json/post/?",favorCheck:"http://bk.pptv.com/xihttp/ikan2/favor/json/check/?",like:"http://bk.pptv.com/xihttp/ikan2/score/json/post/?",likeCheck:"http://bk.pptv.com/xihttp/ikan2/score/json/check/?"};var f=false,b=true;var a={onLogined:new d.CustomEvent("onLogined"),onlogouted:new d.CustomEvent("onlogouted"),userInfo:{Gender:"",PpNum:"",ExpNum:"",LevelName:"",NextLevelName:"",NextLevelExpNum:"",Area:"",Subscribe:"",UnreadNotes:"",HeadPic:"",Email:"",OnlineTime:"",UserName:""},tryReadUserInfo:function(){var l=d.Cookie.read("UDI");var j=d.Cookie.read("PPName");if(l==null||j==null){this.onlogouted.fire();return}var h=j.split("$");this.userInfo.UserName=decodeURIComponent(h[0]);var i=l.split("$");var g=0;for(var k in this.userInfo){if(k=="UserName"){break}this.userInfo[k]=decodeURIComponent(i[g]);g++}f=true;this.onLogined.fire(this.userInfo)},wirteUserInfo:function(i){var g={domain:c,path:"/",duration:7};for(var h in i){d.Cookie.write(h,i[h],g)}},logout:function(){var g={domain:c,path:"/"};d.Cookie.remove("PPKey",g);d.Cookie.remove("UDI",g);d.Cookie.remove("PPName",g);f=false;this.onlogouted.fire()},login:function(i,j){var g=this;var h=e.login+"username="+i+"&password="+j;new d.Loader({url:h,type:"js",callback:function(k,l){g.loginFnc(k,l)},param:true}).load()},loginFnc:function(g,h){if(g==0){alert(h);return}if(g==1){this.usernameel.value="";this.userpwdel.value="";this.hideLoginBox();this.wirteUserInfo(h)}this.tryReadUserInfo()},checkLogined:function(){return f},showLoginBox:function(h){if(b){b=false;this.boxel=d("#loginBox");this.btnpostel=this.boxel.getElement(".btnPost");this.usernameel=this.boxel.getElement(".userName");this.userpwdel=this.boxel.getElement(".userPwd");this.usernameel.value="";this.userpwdel.value="";d(document).addEvent("click",function(j){if(j.target.getAttribute("stopdocumentclick")==null){this.hideLoginBox()}},this);this.boxel.addEvent("click",function(j){if(j.target.tagName!="A"){j.stop()}});this.btnpostel.addEvent("click",function(j){this.checkLoginForm()},this);this.usernameel.addEvent("keydown",function(j){if(j.key=="enter"){this.checkLoginForm()}},this);this.userpwdel.addEvent("keydown",function(j){if(j.key=="enter"){this.checkLoginForm()}},this)}this.boxel.css({display:"block"});var g=0;var i=0;g=h.x;i=h.y;this.boxel.css({top:i,left:g});this.usernameel.focus()},hideLoginBox:function(){this.boxel.css("display","none")},checkLoginForm:function(){if(this.usernameel.value.length==0){this.usernameel.focus();return}if(this.userpwdel.value.length==0){this.userpwdel.focus();return}this.login(this.usernameel.value,this.userpwdel.value)},favor:function(j,i,k,g){var h=(j=="add"?e.addFavor:e.favorCheck)+"type="+i+"&id="+k;new d.Loader({url:h,type:"js",callback:function(l){g(l)},param:true}).load()},like:function(k,i,l,j,g){var h=(k=="add"?e.like:e.likeCheck)+"type="+i+"&id="+l+"&attitude="+j;new d.Loader({url:h,type:"js",callback:function(m){g(m)},param:true}).load()}};if(typeof d.IKan=="undefined"){d.IKan={}}d.IKan.User2=a})(JUI);(function(b){b.register("photo-slide","1.0.0.0");var a=function(f,e,c,d){this.ops={btnTriggerEvent:"click",autoSwitchTime:5000};this.mergeOptions(d);this.pageCount=0;this.selectedPageNum=0;this.width=e;this.height=c;this.tpEl=f;this.init()};b.Native.initialize({name:"PhotoSlide",initialize:a,protect:true});a.implement({mergeOptions:function(c){for(var d in c){this.ops[d]=c[d]}},beginAutoSwitch:function(){if(this.ops.autoSwitchTime<1||this.pageCount<2){return}clearInterval(this.sid);var c=this;this.sid=setInterval(function(){var d=0;if(c.selectedPageNum<c.pageCount-1){d=c.selectedPageNum+1}c.changePage(d)},this.ops.autoSwitchTime)},stopAutoSwitch:function(){clearInterval(this.sid)},init:function(){this.picsEl=this.tpEl.getElement("div.pics");this.picsEl.css({width:this.width,height:this.height,overflow:"hidden"});this.picsMoveEl=this.picsEl.getElement("div");this.picsMoveEl.css({height:this.height,overflow:"hidden"});this.fx=new b.Fx.Morph(this.picsMoveEl,{duration:500,effect:"Quad:in:out"});this.titleEl=this.tpEl.getElement("div.info .title");this.btnsEl=this.tpEl.getElement("div.info .btns");this.tpEl.addEvent("mouseover",function(c){this.stopAutoSwitch()},this);this.tpEl.addEvent("mouseout",function(c){this.beginAutoSwitch()},this);this.fnc()},fnc:function(){this.infos=[];var e=this.picsMoveEl.getElements("div");this.pageCount=e.length;if(this.pageCount==0){return}this.picsMoveEl.css("width",this.pageCount*this.width);var f=[];for(var d=0,c=this.pageCount;d<c;d++){e[d].css({width:this.width,height:this.height,overflow:"hidden","float":"left"});f.push(['<a href="javascript:;">',d+1,"</a>"].join(""));var h=e[d].getElements("a");if(h.length>0){this.infos.push({title:h[0].attr("title"),link:h[0].attr("href")})}else{this.infos.push({title:"No Text",link:""})}}if(this.btnsEl!=null){this.btnsEl.html(f.join(""));var g=this.btnsEl.getElements("a");g.addEvent(this.ops.btnTriggerEvent,function(j){var i=parseInt(b(j.target).html())-1;this.changePage(i)},this)}this.changePage(0);this.beginAutoSwitch()},changePage:function(c){if(this.btnsEl!=null){var d=this.btnsEl.getElements("a");d[this.selectedPageNum].className="";d[c].className="now"}if(this.titleEl!=null){var e=this.infos[c];this.titleEl.html(e.title);this.titleEl.attr("href",e.link)}this.selectedPageNum=c;this.fx.start({"margin-left":-(this.selectedPageNum*this.width)})}});b.PhotoSlide=a})(JUI);(function(c){c.register("ikan.searchtips","1.0.0.0");var b="pplive.com";if(document.domain!=""){b=document.domain.indexOf("pptv.com")!=-1?"pptv.com":b}var a=function(f,e,d){this.inputel=f;this.btnel=e;this.ops={defaultText:"-- 请输入关键字 --",defaultTextColor:"#999999",textColor:"#000000",tipBoxWidth:"182px",strLength:26,searchSuggestUrl:"http://ikan."+b+"/search/suggest/?kw=",searchUrl:"http://ikan."+b+"/search/?kw="};this.mergeOptions(d);this.init()};c.Native.initialize({name:"SearchTips",initialize:a,protect:true});a.implement({mergeOptions:function(d){for(var e in d){this.ops[e]=d[e]}},truncate:function(e,d,h){var f=0,k=[],j=e.length;for(var g=0;g<j;g++){if(e.charCodeAt(g)>255){f+=2}else{f++}if(f>d){break}}return(h&&g<j)?e.substring(0,g)+"...":e.substring(0,g)},getText:function(){return this.inputel.value.replace(/(^\s+)|(\s+$)/gm,"")},setDefaultState:function(){this.inputel.value=this.ops.defaultText;this.inputel.css("color",this.ops.defaultTextColor)},setNormalState:function(d){this.inputel.value=d?d:"";this.inputel.css("color",this.ops.textColor)},init:function(){this.tipsLis=[];this.selectedIx=-1;this.prevText="";this.gotourl="";this.setDefaultState();this.tipboxel=document.createElement("ul");this.tipboxel.className="sm_search_tips";this.tipboxel.style.overflow="hidden";this.tipboxel.style.position="absolute";this.tipboxel.style.zIndex=1000;this.tipboxel.style.width=this.ops.tipBoxWidth;this.tipboxel.style.display="none";document.documentElement.getElementsByTagName("body")[0].appendChild(this.tipboxel);this.inputel.addEvent("focus",this.input_focus,this);this.inputel.addEvent("blur",this.input_blur,this);this.inputel.addEvent("keydown",this.input_key_down,this);this.inputel.addEvent("keyup",this.input_key_up,this);this.btnel.addEvent("click",this.btn_click,this);c(document).addEvent("click",function(){this.hideTipBox()},this)},fillList:function(h){this.tipsLis=[];this.selectedIx=-1;this.prevText=this.getText();if(h.length==0){this.hideTipBox();return}var g=[];for(var f=0,e=h.length;f<e;f++){g.push(['<li><a href="',h[f].link,'">',this.truncate(h[f].name,this.ops.strLength),"</a></li>"].join(""))}this.tipboxel.innerHTML=g.join("");this.tipsLis=this.tipboxel.getElementsByTagName("li");this.showTipBox()},setSelectedItem:function(d){if(this.tipsLis.length==0){return}if(this.selectedIx==-1){this.selectedIx=0}else{this.tipsLis[this.selectedIx].className="";this.selectedIx+=d}if(this.selectedIx<0){this.selectedIx=this.tipsLis.length-1}if(this.selectedIx>=this.tipsLis.length){this.selectedIx=0}this.tipsLis[this.selectedIx].className="current";this.gotourl=this.tipsLis[this.selectedIx].getElementsByTagName("a")[0].href},showTipBox:function(){this.gotourl="";var d=this.inputel.position();this.tipboxel.style.top=d.y+24+"px";this.tipboxel.style.left=d.x+"px";this.tipboxel.style.display="block"},hideTipBox:function(){this.gotourl="";this.tipboxel.style.display="none"},getSuggestList:function(){var d=this;var e=new c.Loader({url:this.ops.searchSuggestUrl+encodeURIComponent(this.getText()),type:"js",callback:function(f){d.fillList.call(d,f)},param:true});e.load()},input_key_up:function(){if(this.getText()==""){this.hideTipBox()}if(this.getText()!=""&&this.getText()!=this.ops.defaultTex&&this.prevText!=this.getText()){var d=this;clearTimeout(this.tid);this.tid=setTimeout(function(){d.getSuggestList()},400)}},input_focus:function(){if(this.getText()==this.ops.defaultText){this.setNormalState()}},input_blur:function(){if(this.getText()==""){this.setDefaultState()}},btn_click:function(){if(this.getText()!=""&&this.getText()!=this.ops.defaultText){window.location.href=this.ops.searchUrl+encodeURIComponent(this.getText())}},input_key_down:function(d){switch(d.key){case"enter":if(this.gotourl!=""){window.location.href=this.gotourl}else{this.btn_click()}break;case"up":this.setSelectedItem(-1);break;case"down":this.setSelectedItem(1);break}}});if(typeof c.IKan=="undefined"){c.IKan={}}c.IKan.SearchTips=a})(JUI);
